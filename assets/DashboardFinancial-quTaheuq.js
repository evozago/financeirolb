import{av as N,u as C,r as i,s as w,i as x,k as b,aw as F,ax as _,ay as k,j as e,az as S,x as o,o as D,y as T,C as m,f as u,g as h,h as g,aA as E,aB as P,aC as B,D as p,aD as R}from"./index-QmxZ3gqB.js";function H(){const n=N(),{toast:j}=C(),[$,d]=i.useState(!0),[a,f]=i.useState({totalPending:0,totalOverdue:0,totalPaidToday:0,totalDueToday:0,cashFlow:0,monthlyExpenses:0});i.useEffect(()=>{v()},[]);const v=async()=>{try{d(!0);const{data:s,error:c}=await w.rpc("get_financial_panel_stats_extended");if(c)throw c;if(s&&s.length>0){const t=s[0];f({totalPending:parseFloat(String(t.contas_pendentes_nao_recorrentes||0)),totalOverdue:parseFloat(String(t.contas_vencidas||0)),totalPaidToday:parseFloat(String(t.contas_pagas_hoje||0)),totalDueToday:parseFloat(String(t.contas_vencendo_hoje||0)),cashFlow:parseFloat(String(t.contas_pagas_hoje||0))-parseFloat(String(t.contas_vencendo_hoje||0)),monthlyExpenses:parseFloat(String(t.contas_vencendo_ate_fim_mes||0))})}}catch(s){console.error("Error loading financial stats:",s),j({title:"Erro",description:"Falha ao carregar dados financeiros",variant:"destructive"})}finally{d(!1)}},r=s=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(s),l=s=>{n(`/accounts-payable?filter=${s}`)},y=[{title:"Fluxo de Caixa Diário",value:r(a.cashFlow),icon:a.cashFlow>=0?x:b,description:"Entradas vs saídas hoje",color:a.cashFlow>=0?"text-green-600":"text-red-600",bgColor:a.cashFlow>=0?"bg-green-50":"bg-red-50",onClick:()=>n("/accounts-payable")},{title:"Contas Vencidas",value:r(a.totalOverdue),icon:F,description:"Necessitam pagamento urgente",color:"text-red-600",bgColor:"bg-red-50",onClick:()=>l("overdue")},{title:"Vencem Hoje",value:r(a.totalDueToday),icon:_,description:"Pagamentos do dia",color:"text-yellow-600",bgColor:"bg-yellow-50",onClick:()=>l("today")},{title:"Pagos Hoje",value:r(a.totalPaidToday),icon:k,description:"Já processados",color:"text-green-600",bgColor:"bg-green-50",onClick:()=>l("paid-today")}];return e.jsx("div",{className:"min-h-screen bg-background",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsx(S,{}),e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-foreground",children:"Dashboard Financeiro"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Controle financeiro e gestão de pagamentos"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(o,{variant:"outline",onClick:()=>n("/recurring-bills/new"),children:[e.jsx(D,{className:"h-4 w-4 mr-2"}),"Nova Conta Recorrente"]}),e.jsxs(o,{onClick:()=>n("/accounts-payable/new"),children:[e.jsx(T,{className:"h-4 w-4 mr-2"}),"Nova Conta"]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:y.map((s,c)=>{const t=s.icon;return e.jsxs(m,{className:"cursor-pointer hover:shadow-md transition-shadow",onClick:s.onClick,children:[e.jsxs(u,{className:"flex flex-row items-center justify-between space-y-0 pb-3",children:[e.jsx(h,{className:"text-xs font-medium text-muted-foreground",children:s.title}),e.jsx("div",{className:`p-2 rounded-full ${s.bgColor}`,children:e.jsx(t,{className:`h-4 w-4 ${s.color}`})})]}),e.jsxs(g,{className:"pt-0",children:[e.jsx("div",{className:`text-xl font-bold ${s.color} mb-1`,children:s.value}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s.description})]})]},c)})}),e.jsx(E,{onCardClick:l}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx("div",{className:"space-y-4",children:e.jsx(P,{})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(B,{}),e.jsxs(m,{children:[e.jsx(u,{children:e.jsxs(h,{className:"flex items-center gap-2",children:[e.jsx(p,{className:"h-5 w-5"}),"Ações Rápidas"]})}),e.jsxs(g,{className:"space-y-3",children:[e.jsxs(o,{variant:"outline",className:"w-full justify-start",onClick:()=>n("/bank-accounts"),children:[e.jsx(p,{className:"h-4 w-4 mr-2"}),"Gerenciar Contas Bancárias"]}),e.jsxs(o,{variant:"outline",className:"w-full justify-start",onClick:()=>n("/suppliers"),children:[e.jsx(R,{className:"h-4 w-4 mr-2"}),"Cadastrar Fornecedores"]}),e.jsxs(o,{variant:"outline",className:"w-full justify-start",onClick:()=>n("/reports"),children:[e.jsx(x,{className:"h-4 w-4 mr-2"}),"Relatórios Financeiros"]}),e.jsxs("div",{className:"pt-3 border-t",children:[e.jsx("div",{className:"text-sm font-medium mb-2",children:"Resumo Mensal"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Despesas do Mês:"}),e.jsx("span",{className:"font-medium",children:r(a.monthlyExpenses)})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Pendentes:"}),e.jsx("span",{className:"font-medium text-yellow-600",children:r(a.totalPending)})]})]})]})]})]})]})]})]})]})})}export{H as default};
