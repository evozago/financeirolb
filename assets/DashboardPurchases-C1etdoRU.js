import{av as V,u as M,r as u,s as g,aE as v,aF as x,aG as c,i as w,j as e,az as R,x as o,y as b,C as n,f as h,g as p,h as i,aH as I,aI as z,ay as G,B as C}from"./index-QmxZ3gqB.js";function L(){const r=V(),{toast:y}=M(),[Y,j]=u.useState(!0),[t,k]=u.useState({totalOrders:0,pendingOrders:0,completedOrders:0,totalSuppliers:0,activeSuppliers:0,monthlyOrderValue:0});u.useEffect(()=>{P()},[]);const P=async()=>{try{j(!0);const{data:s,error:d}=await g.from("pedidos_produtos").select("status, valor_total_liquido, created_at");if(d)throw d;const{data:l,error:f}=await g.from("fornecedores").select("ativo");if(f)throw f;const S=new Date().getMonth(),F=new Date().getFullYear(),B=(s==null?void 0:s.length)||0,E=(s==null?void 0:s.filter(a=>a.status==="pendente").length)||0,T=(s==null?void 0:s.filter(a=>a.status==="concluido").length)||0,A=((s==null?void 0:s.filter(a=>{const m=new Date(a.created_at);return m.getMonth()===S&&m.getFullYear()===F}))||[]).reduce((a,m)=>a+(m.valor_total_liquido||0),0),_=(l==null?void 0:l.length)||0,$=(l==null?void 0:l.filter(a=>a.ativo).length)||0;k({totalOrders:B,pendingOrders:E,completedOrders:T,totalSuppliers:_,activeSuppliers:$,monthlyOrderValue:A})}catch(s){console.error("Error loading purchase stats:",s),y({title:"Erro",description:"Falha ao carregar dados de compras",variant:"destructive"})}finally{j(!1)}},N=s=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(s),O=[{title:"Total de Pedidos",value:t.totalOrders.toString(),icon:v,description:`${t.pendingOrders} pendentes, ${t.completedOrders} finalizados`,color:"text-blue-600",bgColor:"bg-blue-50",onClick:()=>r("/orders")},{title:"Pedidos Pendentes",value:t.pendingOrders.toString(),icon:x,description:"Necessitam acompanhamento",color:"text-yellow-600",bgColor:"bg-yellow-50",onClick:()=>r("/orders?status=pendente")},{title:"Fornecedores Ativos",value:`${t.activeSuppliers}/${t.totalSuppliers}`,icon:c,description:"Parceiros cadastrados",color:"text-green-600",bgColor:"bg-green-50",onClick:()=>r("/suppliers")},{title:"Compras do Mês",value:N(t.monthlyOrderValue),icon:w,description:"Volume financeiro mensal",color:"text-purple-600",bgColor:"bg-purple-50",onClick:()=>r("/orders?period=current-month")}];return e.jsx("div",{className:"min-h-screen bg-background",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsx(R,{}),e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Dashboard Compras"}),e.jsx("p",{className:"text-muted-foreground",children:"Gestão de fornecedores e pedidos de compra"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(o,{variant:"outline",onClick:()=>r("/suppliers/new"),children:[e.jsx(c,{className:"h-4 w-4 mr-2"}),"Novo Fornecedor"]}),e.jsxs(o,{onClick:()=>r("/orders/new"),children:[e.jsx(b,{className:"h-4 w-4 mr-2"}),"Novo Pedido"]})]})]}),e.jsxs("div",{className:"space-y-8",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:O.map((s,d)=>{const l=s.icon;return e.jsxs(n,{className:"cursor-pointer hover:shadow-md transition-shadow",onClick:s.onClick,children:[e.jsxs(h,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(p,{className:"text-sm font-medium",children:s.title}),e.jsx("div",{className:`p-2 rounded-full ${s.bgColor}`,children:e.jsx(l,{className:`h-4 w-4 ${s.color}`})})]}),e.jsxs(i,{children:[e.jsx("div",{className:`text-2xl font-bold ${s.color}`,children:s.value}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:s.description})]})]},d)})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs(n,{children:[e.jsx(h,{children:e.jsxs(p,{className:"flex items-center gap-2",children:[e.jsx(I,{className:"h-5 w-5"}),"Pedidos Recentes"]})}),e.jsxs(i,{className:"space-y-3",children:[e.jsxs(o,{variant:"outline",className:"w-full justify-start",onClick:()=>r("/orders?status=pendente"),children:[e.jsx(x,{className:"h-4 w-4 mr-2"}),"Ver Pedidos Pendentes (",t.pendingOrders,")"]}),e.jsxs(o,{variant:"outline",className:"w-full justify-start",onClick:()=>r("/orders?status=em-andamento"),children:[e.jsx(z,{className:"h-4 w-4 mr-2"}),"Pedidos em Andamento"]}),e.jsxs(o,{variant:"outline",className:"w-full justify-start",onClick:()=>r("/orders?status=concluido"),children:[e.jsx(G,{className:"h-4 w-4 mr-2"}),"Pedidos Finalizados"]}),e.jsxs("div",{className:"pt-3 border-t",children:[e.jsx("div",{className:"text-sm font-medium mb-2",children:"Performance Mensal"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Total em Pedidos:"}),e.jsx("span",{className:"font-medium",children:N(t.monthlyOrderValue)})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Pedidos Ativos:"}),e.jsx("span",{className:"font-medium text-blue-600",children:t.pendingOrders+t.completedOrders})]})]})]})]})]}),e.jsxs(n,{children:[e.jsx(h,{children:e.jsxs(p,{className:"flex items-center gap-2",children:[e.jsx(c,{className:"h-5 w-5"}),"Gestão de Fornecedores"]})}),e.jsxs(i,{className:"space-y-3",children:[e.jsxs(o,{variant:"outline",className:"w-full justify-start",onClick:()=>r("/suppliers"),children:[e.jsx(c,{className:"h-4 w-4 mr-2"}),"Todos os Fornecedores"]}),e.jsxs(o,{variant:"outline",className:"w-full justify-start",onClick:()=>r("/suppliers/new"),children:[e.jsx(b,{className:"h-4 w-4 mr-2"}),"Cadastrar Fornecedor"]}),e.jsxs(o,{variant:"outline",className:"w-full justify-start",onClick:()=>r("/suppliers?status=inactive"),children:[e.jsx(x,{className:"h-4 w-4 mr-2"}),"Fornecedores Inativos"]}),e.jsxs("div",{className:"pt-3 border-t",children:[e.jsx("div",{className:"text-sm font-medium mb-2",children:"Principais Parceiros"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between p-2 bg-muted/50 rounded-md",children:[e.jsx("span",{className:"text-sm",children:"Fornecedores Ativos"}),e.jsx(C,{variant:"outline",children:t.activeSuppliers})]}),e.jsxs("div",{className:"flex items-center justify-between p-2 bg-muted/50 rounded-md",children:[e.jsx("span",{className:"text-sm",children:"Total Cadastrados"}),e.jsx(C,{variant:"outline",children:t.totalSuppliers})]})]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx(n,{className:"cursor-pointer hover:shadow-md transition-shadow",onClick:()=>r("/orders/new"),children:e.jsxs(i,{className:"p-6 text-center",children:[e.jsx(v,{className:"h-8 w-8 mx-auto mb-4 text-primary"}),e.jsx("h3",{className:"font-medium mb-2",children:"Criar Novo Pedido"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Solicitar produtos dos fornecedores cadastrados"})]})}),e.jsx(n,{className:"cursor-pointer hover:shadow-md transition-shadow",onClick:()=>r("/suppliers/new"),children:e.jsxs(i,{className:"p-6 text-center",children:[e.jsx(c,{className:"h-8 w-8 mx-auto mb-4 text-primary"}),e.jsx("h3",{className:"font-medium mb-2",children:"Cadastrar Fornecedor"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Adicionar novos parceiros comerciais"})]})}),e.jsx(n,{className:"cursor-pointer hover:shadow-md transition-shadow",onClick:()=>r("/reports?module=purchases"),children:e.jsxs(i,{className:"p-6 text-center",children:[e.jsx(w,{className:"h-8 w-8 mx-auto mb-4 text-primary"}),e.jsx("h3",{className:"font-medium mb-2",children:"Relatórios"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Análise de compras e fornecedores"})]})})]})]})]})})}export{L as default};
