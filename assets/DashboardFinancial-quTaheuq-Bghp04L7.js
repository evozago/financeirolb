import{av as y,I as w,v as i,l as b,A as x,f as C,aw as _,ax as F,ay as k,i as e,az as P,z as o,k as S,E,h as m,w as h,j,c as p,aA as T,aB as D,aC as $,H as u,aD as R}from"./index-BwnXncx-.js";function I(){const l=y(),{toast:g}=w(),[A,d]=i.useState(!0),[a,f]=i.useState({totalPending:0,totalOverdue:0,totalPaidToday:0,totalDueToday:0,cashFlow:0,monthlyExpenses:0});i.useEffect(()=>{v()},[]);const v=async()=>{try{d(!0);const{data:s,error:c}=await b.rpc("get_financial_panel_stats_extended");if(c)throw c;if(s&&s.length>0){const t=s[0];f({totalPending:parseFloat(String(t.contas_pendentes_nao_recorrentes||0)),totalOverdue:parseFloat(String(t.contas_vencidas||0)),totalPaidToday:parseFloat(String(t.contas_pagas_hoje||0)),totalDueToday:parseFloat(String(t.contas_vencendo_hoje||0)),cashFlow:parseFloat(String(t.contas_pagas_hoje||0))-parseFloat(String(t.contas_vencendo_hoje||0)),monthlyExpenses:parseFloat(String(t.contas_vencendo_ate_fim_mes||0))})}}catch(s){console.error("Error loading financial stats:",s),g({title:"Erro",description:"Falha ao carregar dados financeiros",variant:"destructive"})}finally{d(!1)}},n=s=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(s),r=s=>{l(`/accounts-payable?filter=${s}`)},N=[{title:"Fluxo de Caixa Diário",value:n(a.cashFlow),icon:a.cashFlow>=0?x:C,description:"Entradas vs saídas hoje",color:a.cashFlow>=0?"text-green-600":"text-red-600",bgColor:a.cashFlow>=0?"bg-green-50":"bg-red-50",onClick:()=>l("/accounts-payable")},{title:"Contas Vencidas",value:n(a.totalOverdue),icon:_,description:"Necessitam pagamento urgente",color:"text-red-600",bgColor:"bg-red-50",onClick:()=>r("overdue")},{title:"Vencem Hoje",value:n(a.totalDueToday),icon:F,description:"Pagamentos do dia",color:"text-yellow-600",bgColor:"bg-yellow-50",onClick:()=>r("today")},{title:"Pagos Hoje",value:n(a.totalPaidToday),icon:k,description:"Já processados",color:"text-green-600",bgColor:"bg-green-50",onClick:()=>r("paid-today")}];return e.jsx("div",{className:"min-h-screen bg-background",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsx(P,{}),e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-foreground",children:"Dashboard Financeiro"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Controle financeiro e gestão de pagamentos"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(o,{variant:"outline",onClick:()=>l("/recurring-bills/new"),children:[e.jsx(S,{className:"h-4 w-4 mr-2"}),"Nova Conta Recorrente"]}),e.jsxs(o,{onClick:()=>l("/accounts-payable/new"),children:[e.jsx(E,{className:"h-4 w-4 mr-2"}),"Nova Conta"]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:N.map((s,c)=>{const t=s.icon;return e.jsxs(m,{className:"cursor-pointer hover:shadow-md transition-shadow",onClick:s.onClick,children:[e.jsxs(h,{className:"flex flex-row items-center justify-between space-y-0 pb-3",children:[e.jsx(j,{className:"text-xs font-medium text-muted-foreground",children:s.title}),e.jsx("div",{className:`p-2 rounded-full ${s.bgColor}`,children:e.jsx(t,{className:`h-4 w-4 ${s.color}`})})]}),e.jsxs(p,{className:"pt-0",children:[e.jsx("div",{className:`text-xl font-bold ${s.color} mb-1`,children:s.value}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s.description})]})]},c)})}),e.jsx(T,{onCardClick:r}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx("div",{className:"space-y-4",children:e.jsx(D,{})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx($,{}),e.jsxs(m,{children:[e.jsx(h,{children:e.jsxs(j,{className:"flex items-center gap-2",children:[e.jsx(u,{className:"h-5 w-5"}),"Ações Rápidas"]})}),e.jsxs(p,{className:"space-y-3",children:[e.jsxs(o,{variant:"outline",className:"w-full justify-start",onClick:()=>l("/bank-accounts"),children:[e.jsx(u,{className:"h-4 w-4 mr-2"}),"Gerenciar Contas Bancárias"]}),e.jsxs(o,{variant:"outline",className:"w-full justify-start",onClick:()=>l("/suppliers"),children:[e.jsx(R,{className:"h-4 w-4 mr-2"}),"Cadastrar Fornecedores"]}),e.jsxs(o,{variant:"outline",className:"w-full justify-start",onClick:()=>l("/reports"),children:[e.jsx(x,{className:"h-4 w-4 mr-2"}),"Relatórios Financeiros"]}),e.jsxs("div",{className:"pt-3 border-t",children:[e.jsx("div",{className:"text-sm font-medium mb-2",children:"Resumo Mensal"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Despesas do Mês:"}),e.jsx("span",{className:"font-medium",children:n(a.monthlyExpenses)})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Pendentes:"}),e.jsx("span",{className:"font-medium text-yellow-600",children:n(a.totalPending)})]})]})]})]})]})]})]})]})]})})}export{I as default};
